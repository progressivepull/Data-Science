Sometimes you'd like to do more than just draw points on a map. For example, you might like to know if a location a point is inside the city limits. Cities are represented as Polygon, and the question maps to. Is this point inside that Polygon? There are several libraries in Python to work with what is called GIS geographic Information system and geometry in general. We're going to have a look at one library called shapely. The two main data structures that we're going to use are a point and a poll. So form shapely geometry input point and we're going to create a point and show it. And the interactive prompt is showing at the point as well a point, but you can ask the point what is the dot X and the dot Y of the point. Now let's take a look at the Polygon. So we import the Polygon and create it, and when we run it again, the interactive prompt is going to show us square because this is the Polygon, you can ask Polygon several questions. For example, what is the area and what is the center of the Polygon. You can also ask whether this point is inside the Polygon. By using the intersects method. So for this point, this is true. Let's take a .1020 which is outside the Polygon, and now it's going to be false. So let's load our tracking data. So we're going to use pandas, which is V from our track. We're going to say pass the time column and use it as the index column. Finally, we're going to resample the data in a minute. Frequency. And now we're going to add a new column to the dataframe. This column is going to be a column of points, so we only take the latitude and longitude columns alley point to them, and we use the head command to see what we have. So now we can see we have a new column called point and every value inside of it is a shapely point. So let's define our Polygon. We're going to take the middle latitude and the maximal attitude and the middle longitude and the maximal latitude, and we're going to create our Polygon. Which again is going to look like a square and now we can say which rows in the data frame are inside that Polygon. So we can say data frame point and alley. The Polygon intersect which is going to return us a series of Boolean values. So Boolean indexing to find the rows and we're going to see several rows that are inside. The Polygon. Let's plot the Polygon on the map. This can get a bit tricky since volume expects a series of latitude longitude, while if you ask the Polygon for its exterior, you're going to get 2 arrays, 1 of X's and one of Y's. We're going to do some data shifting here. This is quite common, but lucky for us, Numpy makes it super easy. We're going to use the stack function from Numpy. Let's run Numpy stack on the exterior. And this is almost what we want. We just need to rotate the array by 90Â° to get the pair of coordinates per row. This is called a transpose and is done with the T attribute. Now we have the data in the right shape. It's easy to add it to a map, right? So we're going to create a volume map. With the location in the mean with the zoom start and then do the stack to get the points and the child with the polyline from volume and show the map. And now you see we have this Polygon on the map. Now let's draw our track using different color for points that are in the Polygon or outside. So we're going to define the center to create. Map and then we're going to add the polyline and now we have our add marker. It's going to get the location from the row latitude and check if we're inside the Polygon using the Polygon intersects with the point and now we create a marker and location. The radius is five and then the color is going to be yellow. If we're in the Polygon, otherwise it's going to be green and we also add the OU for the time and add the marker to the map. We call the data frame apply. With the add marker function and access SQL One meaning running it on every row. And let's run this up. And now you can see the track. All the points outside are green and the one inside are yellow. I think it's pretty cool what you can do with very few lines of code to show map interactive with GIS information inside of them. If you work a lot with GIS information, I suggest you look at the package called Geo Pandas which adds. GIS data types to data frames.
